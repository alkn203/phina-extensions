<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>effect/break.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="global.html#init">init</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="phina.accessory.GridLayout.html">GridLayout</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="phina.accessory.RingLayout.html">RingLayout</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="phina.display.TypedLabel.html">TypedLabel</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="phina.effect.Break.html">Break</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="phina.effect.Stump.html">Stump</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="phina.util.Map.html">Map</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="phina.util.Map.html#checkTile">checkTile</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="phina.util.Map.html#checkTileByIndex">checkTileByIndex</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="phina.util.Map.html#getChild">getChild</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="phina.util.Map.html#getChildByIndex">getChildByIndex</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="phina.util.Map.html#hitTest">hitTest</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="phina.util.Map.html#hitTestByIndex">hitTestByIndex</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="phina.util.Map.html#setTile">setTile</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="phina.util.Map.html#setTileByIndex">setTileByIndex</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#elapse%25E3%2582%25BF%25E3%2582%25A4%25E3%2583%259E%25E3%2583%25BC%25E3%2582%25B2%25E3%2583%25BC%25E3%2582%25B8%25E3%2582%2592%25E6%25B8%259B%25E3%2582%2589%25E3%2581%2599">elapseタイマーゲージを減らす</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#pause%25E3%2582%25BF%25E3%2582%25A4%25E3%2583%259E%25E3%2583%25BC%25E3%2582%2592%25E5%2581%259C%25E6%25AD%25A2%25E3%2581%2599%25E3%2582%258B">pauseタイマーを停止する</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#recover%25E3%2582%25BF%25E3%2582%25A4%25E3%2583%259E%25E3%2583%25BC%25E3%2582%25B2%25E3%2583%25BC%25E3%2582%25B8%25E3%2582%2592%25E5%259B%259E%25E5%25BE%25A9%25E3%2581%2599%25E3%2582%258B">recoverタイマーゲージを回復する</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#run%25E3%2582%25BF%25E3%2582%25A4%25E3%2583%259E%25E3%2583%25BC%25E3%2582%2592%25E8%25B5%25B7%25E5%258B%2595%25E3%2581%2599%25E3%2582%258B">runタイマーを起動する</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">effect/break.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>phina.namespace(function() {

  /**
   * @class phina.effect.Break
   */
  phina.define('phina.effect.Break', {
    superClass: 'phina.display.DisplayElement',
    
    /**
     * @constructor
     */
    init: function(sprite, options) {
      options = ({}).$safe(options || {}, phina.effect.Break.defaults);
      // 親クラス初期化
      this.superInit();
      // タイプ
      var type = options.type;
      
      if (type === 'mariolike') {
        this._marioLike(sprite);
      }
    },
    /**
     * @private
     */ 
    _marioLike: function(sprite) {
      // 縦横の分割数
      var divX = 2;
      var divY = 2;

      var image = sprite.image.domElement;
      // 分割サイズ
      var sizeX = sprite.width / divX;
      var sizeY = sprite.height / divY;
      // グリッド
      var grid = phina.util.Grid(sprite.width, divX);
      var srcRect = sprite.srcRect;
      // 分割スプライト作成
      (divX * divY).times(function(i) {
        // インデックス位置設定
        var xIndex = i % divX;
        var yIndex = (i / divX).floor();
        // 新規canvas作成
        var canvas = phina.graphics.Canvas().setSize(sizeX, sizeY);
        var x = srcRect.x + xIndex * sizeX;
        var y = srcRect.y + yIndex * sizeY;
        // canvasに描画
        canvas.context.drawImage(image, x, y, sizeX, sizeY, 0, 0, sizeX, sizeY);
        // 破片作成
        var piece = phina.display.Sprite(canvas).addChildTo(this);
        // 位置指定
        var px = grid.span(xIndex) + sprite.x - piece.width / 2;
        var py = grid.span(yIndex) + sprite.y - piece.height / 2;
        
        piece.setPosition(px, py);
        piece.rotation = 45;
      }, this);
      // 元スプライト削除
      this.spX = sprite.x;
      this.spY = sprite.y;
      sprite.remove();
      // 破片を散らす
      [[-120, 35], [-60, 35], [-150, 20], [-30, 20]].each(function(elem, i) {
        var piece = this.children[i];
        piece.physical.gravity.y = 4.6;
        piece.physical.velocity = phina.geom.Vector2().fromDegree(elem[0], elem[1]);
      }, this);
      // 自身を削除
      var self = this;
      this.tweener.wait(500)
                  .call(function() {
                    self.remove()
                  });
    },
    
    _static: {
      defaults: {
        type: 'mariolike'
      },
    }
  });
});</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.7</a> on Fri Dec 10 2021 01:07:20 GMT+0900 (日本標準時) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
